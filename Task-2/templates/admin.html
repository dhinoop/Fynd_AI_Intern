<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>Admin Dashboard</h1>

{% if not authorized %}
    <p style="color:red;">Unauthorized. Add ?pwd=YOUR_PASSWORD in the URL.</p>
{% else %}

<!-- SAFE SCRIPT BLOCK (No errors) -->
<script>
    var authorized = "{{ 'true' if authorized else 'false' }}";
    var adminPwd = "{{ admin_pwd if admin_pwd else '' }}";
</script>


<!-- Summary -->
<div id="summary" style="margin-bottom:20px;">
    <p>Total Reviews: <span id="total">0</span></p>
    <p>Average Rating: <span id="avg">0</span></p>
</div>

<!-- Analytics -->
<div id="analytics" style="display:flex; gap:20px; flex-wrap:wrap;">
    <div style="width:420px;">
        <h3>Rating Distribution</h3>
        <canvas id="ratingChart"></canvas>
    </div>

    <div style="width:620px;">
        <h3>Reviews (Last 7 Days)</h3>
        <canvas id="trendChart"></canvas>
    </div>
</div>

<!-- Reviews List -->
<h2 style="margin-top:30px;">All Reviews</h2>
<div id="reviews"></div>

<script src="{{ url_for('static', filename='js/app.js') }}"></script>

{% endif %}

</body>
</html>
